<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Víctor Cantera">
    <link rel="icon" href="../../../../assets/img/comercia_ico.png" type="image/x-icon"/ >
    <title>Autorización 3DS2 (HPP) - SDK .NET</title>

    <!-- Bootstrap 4.3.1 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- CSS -->
    <link rel="stylesheet" href="../../../../assets/css/style.css">

    <!-- Script para comprobar los datos de la tarjeta mediante HPP -->
    <script src="../../../../assets/js/rxp-hpp.js"></script> <!-- Available at https://github.com/realexpayments -->
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-light navbar-rpdc mb-3">
        <a class="navbar-brand">
            <img src="../../../../assets/img/log2.svg" width="30" height="30" class="img-fluid" alt="Logo Addon Payments">
            <span class="addonNav">ADDON</span> <span>PAYMENTS</span>
            <span class="d-none d-sm-none d-lg-inline d-xl-inline sdkNav">
                <span>
                    /SDK
                    <span class="barraNav">_</span>
                    de
                    <span class="barraNav">_</span>
                    .NET
                </span>
            </span>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </a>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto pl-2 pr-2">
                <li class="nav-item dropdown">
                    <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Inicio
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item pl-2" href="../../../../index.html">Índice</a>
                        <a class="dropdown-item pl-2" href="../../../errores.html">Errores de Addon Payments</a>
                        <a class="dropdown-item pl-2" href="../../../informe.html">Convertir informe</a>
                    </div>
                </li>
                <li class="nav-item ml-1 dropdown">
                    <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Pagos con tarjeta
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                        <div class="dropdown-header text-center p-0">API</div>
                        <hr class="m-0 p-0">
                        <a class="dropdown-item pl-2" href="../../../API/01%20-%20Pagos_con_tarjeta/01%20-%20Autorización/index.html">Autorización</a>
                        <a class="dropdown-item pl-2" href="../../../API/01%20-%20Pagos_con_tarjeta/01%20-%20Autorización/DatosDelCliente.html">Datos adicionales</a>
                        <a class="dropdown-item pl-2" href="../../../API/01%20-%20Pagos_con_tarjeta/02%20-%20OTB/index.html">OTB</a>
                        <a class="dropdown-item pl-2" href="../../../API/01%20-%20Pagos_con_tarjeta/03%20-%20Credit/index.html">Credit</a>
                        <hr class="m-0 p-0">
                        <div class="dropdown-header text-center p-0">HPP</div>
                        <hr class="m-0 p-0">
                        <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/01%20-%20Autorizacion/index.html">Autorización</a>
                        <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/02%20-%20OTB/index.html">OTB</a>
                        <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/03%20-%20Pay%20By%20Link/index.html">Pay By Link</a>
                        <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/04%20-%20Auth%20con%20iframe/index.html">Iframe</a>
                        <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/05%20-%20Lightbox/index.html">Lightbox</a>
                    </div>
                </li>
                <li class="nav-item ml-1 dropdown">
                    <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Almacenamiento de tarjeta
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                        <div class="dropdown-header text-center p-0">API</div>
                        <hr class="m-0 p-0">
                        <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/01%20-%20Crear%20un%20cliente/index.html">Crear un cliente</a>
                        <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/02%20-%20Almacenar%20una%20tarjeta/index.html">Almacenar una tarjeta</a>
                        <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/03%20-%20Editar%20tarjeta/index.html">Editar tarjetas</a>
                        <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/04%20-%20Eliminar%20tarjeta/index.html">Eliminar tarjetas</a>
                        <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/05%20-%20Auth/index.html">Autorización</a>
                        <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/06%20-%20Credit/index.html">Credit</a>
                        <hr class="m-0 p-0">
                        <div class="dropdown-header text-center p-0">HPP</div>
                        <hr class="m-0 p-0">
                        <a class="dropdown-item pl-2" href="../../02%20-%20Almacenamiento%20de%20tarjeta/01%20-%20Crear%20un%20cliente/index.html">Crear un cliente</a>
                        <a class="dropdown-item pl-2" href="../../02%20-%20Almacenamiento%20de%20tarjeta/02%20-%20Mostrar%20Tarjetas/index.html">Mostrar tarjetas</a>
                    </div>
                </li>

                <li class="nav-item ml-1 dropdown">
                    <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Gestión de transacciones
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item pl-2" href="../../../API/03%20-%20Gestión%20de%20transacciones/01%20-%20Capturar/index.html">Settle (Capturar)</a>
                        <a class="dropdown-item pl-2" href="../../../API/03%20-%20Gestión%20de%20transacciones/02%20-%20Rebate/index.html">Rebate (Devolución)</a>
                        <a class="dropdown-item pl-2" href="../../../API/03%20-%20Gestión%20de%20transacciones/03%20-%20Void/index.html">Void (Anular transacción)</a>
                    </div>
                </li>

                <li class="nav-item ml-1 dropdown">
                    <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Filtro de fraude
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">

                        <div class="dropdown-header text-center p-0">API</div>
                        <hr class="m-0 p-0">
                        <a class="dropdown-item pl-2" href="../../../API/05%20-%20Fraud%20Management/01%20-%20Fraud%20Filter/index.html">Filtro de fraude</a>
                        <a class="dropdown-item pl-2" href="../../../API/05%20-%20Fraud%20Management/02%20-%20Address%20Verification">Verificación de dirección</a>
                        <a class="dropdown-item pl-2" href="../../../API/05%20-%20Fraud%20Management/03%20-%20Hold">Retener transacción</a>
                        <a class="dropdown-item pl-2" href="../../../API/05%20-%20Fraud%20Management/04%20-%20Lanzamiento">Lanzar transacción</a>
                        <hr class="m-0 p-0">
                        <div class="dropdown-header text-center p-0">HPP</div>
                        <hr class="m-0 p-0">
                        <a class="dropdown-item pl-2" href="../../03%20-%20Fraud%20Management/01%20-%20Fraud%20Filter/index.html">Filtro de fraude</a>
                    </div>
                </li>

                <li class="nav-item ml-1 dropdown">
                    <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        DCC
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                        <div class="dropdown-header text-center p-0">HPP</div>
                        <hr class="m-0 p-0">
                        <a class="dropdown-item pl-2" href="../../04%20-%20DCC/index.html">Operación con DCC</a>
                    </div>
                </li>
                <li class="nav-item ml-1 dropdown">
                    <a class="nav-link pl-2 dropdown-toggle active" href="#" id="06-3DS2" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        3DS2
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                        <div class="dropdown-header text-center p-0">API</div>
                        <hr class="m-0 p-0">
                        <a class="dropdown-item pl-2" href="../../../API/06%20-%203DS2/01%20-%20Autorización/index.html">Autorización</a>
                        <hr class="m-0 p-0">
                        <div class="dropdown-header text-center p-0">HPP</div>
                        <hr class="m-0 p-0">
                        <a class="dropdown-item pl-2 active" href="#">Autorización</a>
                        <a class="dropdown-item pl-2" href="../02%20-%20Datos%20adicionales/index.html">Datos adicionales</a>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
    <!-- /NAVBAR -->

    <div class="col-lg-12">
        <div id="contenidoComun" class="container-fluid">
            <div class="row">

                <!-- Menú lateral -->
                <div class="col-lg-2 sticky-top d-none d-sm-none d-lg-block d-xl-block MenuLateral">

                    <!-- Barra de progreso -->
                    <div class="progress-bar" id="progreso"></div>
                    <!-- /Barra de progreso -->

                    <nav class="navbar sticky-top navbar-light" style="padding: 0px;">
                        <nav class="nav nav-pills flex-column">
                            <a class="nav-link" href="#3ds2Info">1. 3D Secure 2</a>
                            <nav>
                                <a class="nav-link ml-3 my-1" href="#exenciones">1.1 Exenciones</a>
                            </nav>
                            <a class="nav-link" href="#peticion">2. Petición</a>
                            <nav>
                                <a class="nav-link ml-3 my-1" href="#ConfigTerminal">2.1 Configuración del terminal</a>
                                <a class="nav-link ml-3 my-1" href="#camposOblig">2.2 Campos obligatorios</a>
                                <a class="nav-link ml-3 my-1" href="#envioOP">2.3 Envío de la operación archivo .NET</a>
                                <a class="nav-link ml-3 my-1" href="#envioOPHTML">2.4 Envío de la operación archivo HTML</a>
                            </nav>
                            <a class="nav-link" href="#authFlujos">3. Flujos de autenticación</a>
                            <nav>
                                <a class="nav-link ml-3 my-1" href="#flujoSinFric">3.1 Flujo sin fricción</a>
                                <a class="nav-link ml-3 my-1" href="#flujoConFric">3.2 Flujo con fricción</a>
                                <a class="nav-link ml-3 my-1" href="#simulador">3.3 Simulador ACS</a>
                                <a class="nav-link ml-3 my-1" href="#resultadoDesafio">3.4 Resultado del desafío</a>
                            </nav>
                            <a class="nav-link" href="#FormEjemplo1">4. Formulario de ejemplo</a>
                            <nav>
                                <a class="nav-link ml-3 my-1" href="#Formulario">4.1 Formulario</a>
                                <a class="nav-link ml-3 my-1" href="#respuestaForm">4.2 Respuesta de operación</a>
                            </nav>
                        </nav>
                    </nav>
                </div>
                <div class="col-lg-10">
                    <div class="contenedor">
                        <div class="pl-3 pt-3 pr-3 pb-4 mb-3 text-justify">
                            <h3 id="3ds2Info" class="titulo">
                                1. 3D Secure 2
                            </h3>

                            <hr>

                            <p>
                                3D Secure (3DS) es un protocolo de autenticación que tiene como objetivo reducir el fraude, aumentar la seguridad del titular de la tarjeta y reducir la responsabilidad del comercio por las devoluciones. Se introduce un paso en el proceso de transacción en el que se muestra al cliente una pantalla alojada por o en nombre de su Emisor y se le solicita que se autentique, a menudo a través de una contraseña o información similar que solo el cliente conoce.
                            </p>
                            <p>
                                3DS 2 está diseñado teniendo en cuenta la experiencia de pago móvil mediante la introducción de nuevos flujos de pago que se adaptan mejor a los clientes que pagan en el móvil con nuevos métodos de autenticación, como la biometría, o la opción de un flujo sin fricciones mediante el uso de un conjunto de datos más completo proporcionado por el comercio para autenticar al cliente sin necesidad de su intervención.
                            </p>
                            <p>
                                La página de pago alojada de Addon Payments gestionará todo el flujo de autenticación de 3D Secure, incluida la determinación de qué versión de 3D Secure utilizar, la recopilación de la información necesaria del dispositivo y la presentación del desafío al cliente si es necesario. Finalmente, el HPP procesará la autorización con la información de autenticación adicional transmitida al Emisor.
                            </p>

                            <h5 class="pt-3" id="exenciones">1.1 Exenciones</h5>

                            <hr>

                            <p>
                                Una de las ventajas clave de 3D Secure 2 es que proporciona un marco para que los comercios se beneficien de las exenciones de SCA en determinadas condiciones. La idea detrás de estas exenciones es permitir el desarrollo de una experiencia de pago fácil de usar en circunstancias donde el riesgo es bajo.
                            </p>

                            <p>
                                El Emisor puede aplicar exenciones en función de los detalles de la transacción o el comercio puede solicitarlas específicamente, con el permiso de su Adquirente.
                                En el mensaje de autenticación, puede solicitar una exención incluyéndola en el campo "Challenge indicator" (consulte la nota a continuación).
                            </p>

                            <p class="alert alert-primary" role="alert">
                                Cuando un comercio solicita una exención, ya no podrá hacer uso de un cambio de responsabilidad en caso de una devolución de cargo.
                                <small class="form-text text-muted">
                                    --> Para solicitudes de exención de Mastercard, consulte también nuestra <a href="https://developer.globalpay.com/ecommerce/3d-secure-version2/message-extension#mastercard">documentación de Extensión de mensajes de Mastercard.</a>
                                </small>
                            </p>
                        </div>
                    </div>

                    <div class="contenedor">
                        <div class="pl-3 pt-3 mb-4 pb-1 pr-3 text-justify">
                            <h3 class="pt-1" id="peticion">
                                2. Petición
                            </h3>

                            <hr>

                            <p>
                                En este ejemplo, solo estamos pasando campos obligatorios junto con algunos recomendados.
                                Cuantos más campos opcionales envíe y los datos que proporcione, es más probable que la autenticación de la transacción sea fluida.
                                Para obtener la lista completa de campos opcionales y los valores permitidos en cada uno, consulte la sección <a href="../02%20-%20Datos%20adicionales/index.html">"Datos opcionales 3DS2 HPP"</a>.
                            </p>

                            <div class="p-4 panelCode">
                                <code>
                                    <span class="etiqueta">using </span><span class="variables">Microsoft.AspNetCore.Mvc;</span>
                                    <br>
                                    <span class="etiqueta">using </span><span class="variables">GlobalPayments.Api;</span>
                                    <br>
                                    <span class="etiqueta">using </span><span class="variables">GlobalPayments.Api.Entities;</span>
                                    <br>
                                    <span class="etiqueta">using </span><span class="variables">GlobalPayments.Api.Services;</span>
                                    <br>
                                    <br>
                                    <span class="etiqueta">namespace </span><span class="variables">AddonPayments.Controllers._3DS2 {</span>
                                    <br>
                                    <span class="pl-4 variables">[</span><span class="imports">ApiController</span><span class="variables">]</span>
                                    <br>
                                    <span class="pl-4 variables">[</span><span class="imports">Route</span><span class="variables">(</span><span class="orange">"api/[controller]"</span><span class="variables">)]</span>
                                    <br>
                                    <br>
                                    <span class="pl-4 etiqueta">public class </span><span class="imports">AuthHpp3DS2Controller</span><span class="variables">: </span><span class="imports">ControllerBase </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-5 variables">[</span><span class="imports">HttpPost</span><span class="variables">]</span>
                                    <br>
                                    <span class="pl-5 etiqueta">public </span><span class="service">IActionResult </span><span class="variables">AuthHpp3DS2() {</span>
                                    <br>
                                    <br>
                                    <span class="pl-6 comments">// Configuramos los datos de nuestro comercio. Los datos son proporcionados por el equipo de Addon Payments,</span>
                                    <br>
                                    <span class="pl-6 comments">// en caso de duda debe llamar al 914 353 028 e indicar su número de comercio o Merchant ID</span>
                                    <br>
                                    <span class="pl-6 new">var </span><span class="variables">service = </span><span class="new">new </span><span class="imports">HostedService</span><span class="variables">(</span><span class="new">new </span><span class="imports">GatewayConfig </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-7 variables">MerchantId = </span><span class="orange">"addonnettest"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">AccountId = </span><span class="orange">"3ds2"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">SharedSecret = </span><span class="orange">"secret"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">ServiceUrl = </span><span class="orange">"https://hpp.sandbox.addonpayments.com/pay"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">HostedPaymentConfig = </span><span class="new">new </span><span class="imports">HostedPaymentConfig </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-9 variables">Version = </span><span class="orange">"2"</span>
                                    <br>
                                    <span class="pl-7 variables">}</span>
                                    <br>
                                    <span class="pl-6 variables">});</span>
                                    <br>
                                    <br>
                                    <span class="pl-6 comments">// Añadimos campos obligatorios y recomendados de 3D Secure 2</span>
                                    <br>
                                    <span class="pl-6 new">var </span><span class="variables">hostedPaymentData = </span><span class="new">new </span><span class="imports">HostedPaymentData </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-7 variables">CustomerEmail = </span><span class="orange">"soporte@addonpayments.com"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">CustomerPhoneMobile = </span><span class="orange">"34|914353028"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">AddressesMatch = </span><span class="new">false</span>
                                    <br>
                                    <span class="pl-6 variables">};</span>
                                    <br>
                                    <br>
                                    <span class="pl-6 comments">// Dirección de facturación</span>
                                    <br>
                                    <span class="pl-6 new">var </span><span class="variables">billingAddress = </span><span class="new">new </span><span class="imports">Address </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-7 variables">StreetAddress1 = </span><span class="orange">"Dirección de facturación 1"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">StreetAddress2 = </span><span class="orange">"Dirección de facturación 2"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">StreetAddress3 = </span><span class="orange">"Dirección de facturación 3"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">City = </span><span class="orange">"Elche"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">PostalCode = </span><span class="orange">"03201"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">Country = </span><span class="orange">"724"</span>
                                    <br>
                                    <span class="pl-6 variables">};</span>
                                    <br>
                                    <br>
                                    <span class="pl-6 comments">// Dirección de envío</span>
                                    <br>
                                    <span class="pl-6 new">var </span><span class="variables">shippingAddress = </span><span class="new">new </span><span class="imports">Address </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-7 variables">StreetAddress1 = </span><span class="orange">"Dirección de envío 1"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">StreetAddress2 = </span><span class="orange">"Dirección de envío 2"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">StreetAddress3 = </span><span class="orange">"Dirección de envío 3"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">City = </span><span class="orange">"Elche"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">State = </span><span class="orange">"ES"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">PostalCode = </span><span class="orange">"03201"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-7 variables">Country = </span><span class="orange">"724"</span>
                                    <br>
                                    <span class="pl-6 variables">};</span>
                                    <br>
                                    <br>
                                    <span class="pl-6 comments">// Lanzamos la petición al servidor de Addon Payments</span>
                                    <br>
                                    <span class="pl-6 new">try </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-7 new">var </span><span class="variables">hppJson = service.Charge(</span><span class="imports">19.95m</span><span class="variables">)</span>
                                    <br>
                                    <span class="pl-9 variables">.WithCurrency(</span><span class="orange">"EUR"</span><span class="variables">)</span>
                                    <br>
                                    <span class="pl-9 variables">.WithHostedPaymentData(hostedPaymentData)</span>
                                    <br>
                                    <span class="pl-9 variables">.WithAddress(billingAddress, </span><span class="imports">AddressType</span><span class="variables">.Billing)</span>
                                    <br>
                                    <span class="pl-9 variables">.WithAddress(shippingAddress, </span><span class="imports">AddressType</span><span class="variables">.Shipping)</span>
                                    <br>
                                    <span class="pl-9 variables">.Serialize();</span>
                                    <br>
                                    <br>
                                    <span class="comments pl-7">// Obtenemos la respuesta del servidor y redireccionamos al cliente a la pasarela de pagos</span>
                                    <br>
                                    <span class="pl-7 new">return </span><span class="variables">Content(hppJson);</span>
                                    <br>
                                    <br>
                                    <span class="pl-6 variables">}</span><span class="new"> catch </span><span class="variables">(</span><span class="imports">ApiException </span><span class="variables">exce</span><span class="variables">) {</span>
                                    <br>
                                    <span class="comments pl-7">// Añada aquí su tratamiento de errores</span>
                                    <br>
                                    <span class="pl-7 new">return </span><span class="variables">Ok(exce);</span>
                                    <br>
                                    <span class="pl-6 variables">}</span>
                                    <br>
                                    <span class="pl-5 variables">}</span>
                                    <br>
                                    <span class="pl-4 variables">}</span>
                                    <br>
                                    <span class="variables">}</span>
                                </code>
                            </div>


                            <h5 id="ConfigTerminal" class="mt-3">2.1 Configuración del terminal</h5>
                            <p>
                                Debemos introducir los datos de configuración que se facilitan en la llamada de cualificación del soporte técnico de Addon Payments.
                            </p>
                            <ul>
                                <li>
                                    MerchantId = Identificador del comercio.
                                </li>
                                <li>
                                    AccountId = Subcuenta faciltiada en la llamada de cualificación (si se deja en blanco se envía la subcuenta por defecto que le hayan creado).
                                </li>
                                <li>
                                    SharedSecret = Contraseña de seguridad del terminal.
                                </li>
                            </ul>
                            <small class="form-text text-muted alert alert-primary">
                                --&gt; En caso de que le falte algún dato de los mencionados arriba, debe contactar con su soporte técnico de Addon Payments llamando al teléfono <a href="tel:914353028">914 353 028 (opción 2)</a> o enviando un email al correo electrónico <a target="_blank" href="mailto:soporte@addonpayments.com">soporte@addonpayments.com</a>.
                            </small>
                            <div class="p-4 mb-4 panelCode">
                                <code>
                                    <span class="new">var </span><span class="variables">service = </span><span class="new">new </span><span class="imports">HostedService</span><span class="variables">(</span><span class="new">new </span><span class="imports">GatewayConfig </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-4 variables">MerchantId = </span><span class="orange">"addonnettest"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">AccountId = </span><span class="orange">"3ds2"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">SharedSecret = </span><span class="orange">"secret"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">ServiceUrl = </span><span class="orange">"https://hpp.sandbox.addonpayments.com/pay"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">HostedPaymentConfig = </span><span class="new">new </span><span class="imports">HostedPaymentConfig </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-6 variables">Version = </span><span class="orange">"2"</span>
                                    <br>
                                    <span class="pl-4 variables">}</span>
                                    <br>
                                    <span class="variables">});</span>
                                </code>
                            </div>

                            <hr>

                            <h5 id="camposOblig" class="mt-3">
                                2.2 Campos obligatorios
                            </h5>

                            <p>
                                Debemos enviar la información recopilada del cliente:
                                <ul>
                                    <li>Email</li>
                                    <li>Teléfono</li>
                                    <li>Indicar a "True" si la dirección de facturación y envío es la misma</li>
                                    <li>Dirección de facturación y envío del cliente</li>
                                </ul>
                            </p>

                            <div class="p-4 mb-4 panelCode">
                                <code>
                                    <span class="comments">// Añadimos campos obligatorios y recomendados de 3D Secure 2</span>
                                    <br>
                                    <span class="new">var </span><span class="variables">hostedPaymentData = </span><span class="new">new </span><span class="imports">HostedPaymentData </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-4 variables">CustomerEmail = </span><span class="orange">"soporte@addonpayments.com"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">CustomerPhoneMobile = </span><span class="orange">"34|914353028"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">AddressesMatch = </span><span class="new">false</span>
                                    <br>
                                    <span class="variables">};</span>
                                    <br>
                                    <br>
                                    <span class="comments">// Dirección de facturación</span>
                                    <br>
                                    <span class="new">var </span><span class="variables">billingAddress = </span><span class="new">new </span><span class="imports">Address </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-4 variables">StreetAddress1 = </span><span class="orange">"Dirección de facturación 1"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">StreetAddress2 = </span><span class="orange">"Dirección de facturación 2"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">StreetAddress3 = </span><span class="orange">"Dirección de facturación 3"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">City = </span><span class="orange">"Elche"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">PostalCode = </span><span class="orange">"03201"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">Country = </span><span class="orange">"724"</span>
                                    <br>
                                    <span class="variables">};</span>
                                    <br>
                                    <br>
                                    <span class="comments">// Dirección de envío</span>
                                    <br>
                                    <span class="new">var </span><span class="variables">shippingAddress = </span><span class="new">new </span><span class="imports">Address </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-4 variables">StreetAddress1 = </span><span class="orange">"Dirección de envío 1"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">StreetAddress2 = </span><span class="orange">"Dirección de envío 2"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">StreetAddress3 = </span><span class="orange">"Dirección de envío 3"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">City = </span><span class="orange">"Elche"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">State = </span><span class="orange">"ES"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">PostalCode = </span><span class="orange">"03201"</span><span class="variables">,</span>
                                    <br>
                                    <span class="pl-4 variables">Country = </span><span class="orange">"724"</span>
                                    <br>
                                    <span class="variables">};</span>
                                </code>
                            </div>

                            <hr>

                            <h5 id="envioOP" class="mt-3">
                                2.3 Envío de la operación archivo .NET
                            </h5>

                            <p>
                                Para enviar la operación debemos emplear el modelo de excepciones "try - catch".
                                <small class="form-text text-muted alert alert-primary">
                                    --&gt;Para obtener más información sobre la excepción de "try - catch" puede ver la <a target="_blank" href="https://docs.microsoft.com/es-es/dotnet/standard/exceptions/how-to-use-the-try-catch-block-to-catch-exceptions">documentación oficial de .NET</a>
                                </small>
                            </p>
                            <ul>
                                <li>
                                    Llamamos al objeto "hppJson" e indicamos el importe que queremos cargar:
                                    <span class="variableBgW">service</span><span class="arrow">.Charge(</span><span class="variableBgW">19.95m</span><span class="arrow">)</span>
                                </li>

                                <br>

                                <li>
                                    Indicamos la moneda en la que vamos a realizar el cargo:
                                    <span class="arrow">.WithCurrency(</span><span class="comentariosBgW">"EUR"</span><span class="arrow">)</span>
                                </li>

                                <br>

                                <li>
                                    Indicamos la información del cliente:
                                    <span class="arrow">.WithHostedPaymentData(</span><span class="variableBgW">hostedPaymentData</span><span class="arrow">)</span>
                                </li>

                                <br>

                                <li>
                                    Indicamos la dirección de facturación:
                                    <span class="arrow">.WithAddress(</span><span class="variableBgW">billingAddress</span><span class="arrow">, AddressType</span><span class="variableBgW">.Billing</span><span class="arrow">)</span>
                                </li>

                                <br>

                                <li>
                                    Indicamos la dirección de envío:
                                    <span class="arrow">.WithAddress(</span><span class="variableBgW">shippingAddress</span><span class="arrow">, AddressType</span><span class="variableBgW">.Shipping</span><span class="arrow">)</span>
                                </li>

                                <br>

                                <li>
                                    Por último, enviamos la petición:
                                    <span class="arrow">.Serialize();</span>
                                </li>
                            </ul>
                            <div class="p-4 mb-4 panelCode">
                                <code>
                                    <span class="new">try </span><span class="variables">{</span>
                                    <br>
                                    <span class="pl-4 new">var </span><span class="variables">hppJson = service.Charge(</span><span class="imports">19.95m</span><span class="variables">)</span>
                                    <br>
                                    <span class="pl-7 variables">.WithCurrency(</span><span class="orange">"EUR"</span><span class="variables">)</span>
                                    <br>
                                    <span class="pl-7 variables">.WithHostedPaymentData(hostedPaymentData)</span>
                                    <br>
                                    <span class="pl-7 variables">.WithAddress(billingAddress, </span><span class="imports">AddressType</span><span class="variables">.Billing)</span>
                                    <br>
                                    <span class="pl-7 variables">.WithAddress(shippingAddress, </span><span class="imports">AddressType</span><span class="variables">.Shipping)</span>
                                    <br>
                                    <span class="pl-7 variables">.Serialize();</span>
                                    <br>
                                    <br>
                                    <span class="pl-4 comments">// Obtenemos la respuesta del servidor y redireccionamos al cliente a la pasarela de pagos</span>
                                    <br>
                                    <span class="pl-4 new">return </span><span class="variables">Content(hppJson);</span>
                                    <br>
                                    <br>
                                    <span class="variables">}</span><span class="new"> catch </span><span class="variables">(</span><span class="imports">ApiException </span><span class="variables">exce</span><span class="variables">) {</span>
                                    <br>
                                    <span class="comments pl-4">// Añada aquí su tratamiento de errores</span>
                                    <br>
                                    <span class="pl-4 new">return </span><span class="variables">Ok(exce);</span>
                                    <br>
                                    <span class="variables">}</span>
                                </code>
                            </div>
                            <p class="pb-4">
                                Para la respuesta realizamos un <span class="arrow">return Ok()</span> de "<span class="arrow">exce</span>".
                                <br>
                                <br>
                                Con esta función obtenemos el motivo de la denegación del servidor. Para ver todos los errores de denegación actualizados, puede comprobar nuestra <a target="_blank" href="https://desarrolladores.addonpayments.com/#!/technical-resources/messages">documentación de Addon Payments.</a>
                            </p>

                            <hr>

                            <h5 id="envioOPHTML" class="mt-3">
                                2.4 Envío de la operación archivo HTML
                            </h5>

                            <p>
                                Para lanzar la operación desde nuestro HTML, debemos emplear lo siguientes parámetros:
                            </p>
                            <ul>
                                <li>
                                    Indicamos la ruta del controlador que realiza la petición:
                                    <span class="arrow">$.getJSON(</span><span class="comentariosBgW">"/request"</span><span class="arrow">)</span>
                                </li>

                                <br>

                                <li>
                                    Posteriormente debemos indicar la URL del servidor de Addon Payments:
                                    <span class="arrow">setHppUrl(</span><span class="comentariosBgW">"https://hpp.sandbox.addonpayments.com/pay"</span><span class="arrow">);</span>
                                </li>

                                <br>

                                <li>
                                    Por último, debemos indicar el identificador del botón y la ruta del archivo de respuesta:
                                    <span class="arrow">redirect.init(</span><span class="comentariosBgW">"payButtonId"</span><span class="arrow">,</span> <span class="comentariosBgW">"https://midominio.es/response"</span><span class="arrow">);</span>
                                </li>
                            </ul>
                            <div class="p-4 mb-4 panelCode">
                                <code>
                                    <span class="pl-2 new"><</span><span class="script">script</span><span class="new">></span>
                                    <br>
                                    <span class="pl-4">$</span><span class="require">(</span><span class="service">document</span><span class="require">).</span><span class="new">ready(</span><span class="function">function</span><span class="new">() {</span>
                                    <br>
                                    <span class="pl-5">$.</span><span class="new">getJSON(</span><span class="require">"</span><span class="green">/request</span><span class="require">"</span><span class="new">,</span> <span class="function">function</span><span class="require">(</span><span class="orange">jsonFromRequestEndpoint</span><span class="require">) {</span>
                                    <br>
                                    <span class="pl-5 service">RealexHpp</span><span class="new">.setHppUrl(</span><span class="require">"</span><span class="green">https://hpp.sandbox.addonpayments.com/pay</span><span class="require">"</span><span class="new">);</span>
                                    <br>
                                    <span class="pl-5 service">RealexHpp</span><span class="new">.redirect.init(</span><span class="require">"</span><span class="green">payButtonId</span><span class="require">"</span><span class="new">,</span> <span class="require">"</span><span class="green">https://midominio.es/response</span><span class="require">"</span><span class="new">,</span> <span class="variables">jsonFromRequestEndpoint</span><span class="new">);</span>
                                    <br>
                                    <span class="pl-5 new">});</span>
                                    <br>
                                    <span class="pl-4 new">});</span>
                                    <br>
                                    <span class="pl-2 new"><</span><span class="script">/script</span><span class="new">></span>
                                </code>
                            </div>
                        </div>
                    </div>

                    <div class="contenedor">
                        <div class="pl-3 pt-3 pr-3 pb-4 mb-3 text-justify">
                            <h3 class="pt-1" id="authFlujos">
                                3. Flujos de autenticación
                            </h3>

                            <hr>

                            <p>
                                En este punto, el Emisor analizará la transacción. Tendrá en cuenta factores como los datos que su aplicación ha proporcionado junto con el comportamiento histórico del cliente y el análisis de transacciones.
                                El resultado de este proceso determinará si el Emisor decide que el cliente debe autenticar aún más la transacción y realizar una comprobación con el ACS (flujo con fricción).
                            </p>

                            <hr>

                            <h5 class="pt-1" id="flujoSinFric">
                                3.1 Flujo sin fricción
                            </h5>

                            <p>
                                En un flujo sin fricciones, el Emisor puede determinar que no se requiere autenticación adicional, que la transacción puede continuar.
                                O en base a la información que ha recibido hasta ahora, que la transacción no debería continuar.
                            </p>

                            <p>
                                En un escenario de transacción bloqueada, Addon Payments devolverá un mensaje de respuesta de falla a su aplicación/sitio web y puede optar por redirigir al cliente a la página de pago mientras le informa del resultado.
                                De lo contrario, el HPP completará el proceso de autenticación y procederá a la autorización, incluidos los datos de autenticación de 3D Secure.
                            </p>

                            <hr>

                            <h5 class="pt-1" id="flujoConFric">
                                3.2 Flujo con fricción
                            </h5>

                            <p>
                                En el caso de un flujo de fricción, el Emisor ha determinado que el cliente debe autenticar aún más la transacción.
                                El HPP mostrará el Emisor ACS al cliente.
                                El desafío puede implicar una serie de pasos, incluido que el cliente ingrese una contraseña de un solo uso enviada a su teléfono o responda algunas preguntas que solo él sabría responder.
                            </p>
                            <p>
                                El Emisor ACS determinará el tipo de desafío que se mostrará al cliente y se alineará con al menos dos elementos de la autenticación sólida del cliente (SCA):
                                <ul>
                                    <li><b>Possession:</b> Algo que solo el cliente tiene, por ejemplo, su dispositivo móvil registrado en su banco en el que recibirá un código en un SMS.</li>
                                    <li><b>Inherence:</b> Su huella digital u otra forma de datos biométricos.</li>
                                    <li><b>Knowledge:</b> Una frase de contraseña única o la respuesta a una pregunta personal.</li>
                                </ul>
                            </p>

                            <hr>

                            <h5 class="pt-1" id="simulador">
                                3.3 Simulador ACS
                            </h5>

                            <p>
                                En el entorno sandbox (pruebas), Addon Payments proporciona un simulador de Emisor ACS que le permite probar diferentes resultados de desafíos.
                            </p>

                            <p>
                                Una vez que se haya cargado el desafío, después de diez segundos, el simulador completará automáticamente la autenticación y generará una respuesta de Autenticación exitosa (transStatus = “Y”).
                                Esto tiene la intención de imitar un escenario en el que un cliente ha recibido una notificación en su teléfono para autenticarse usando su aplicación bancaria.
                            </p>

                            <p>
                                Para simular una autenticación fallida, hacer clic en el botón "Cancelar" generará una respuesta fallida (transStatus = “N”).
                                En cualquier escenario, el resultado se enviará en el mensaje de respuesta de desafío (CRes) al punto final de notificación de desafío.
                            </p>
                            <div class="col-12 text-center">
                                <img src="../../../../assets/img/3ds2ACS.png" alt="Simulador ACS">
                            </div>

                            <hr>

                            <h5 class="pt-1" id="resultadoDesafio">
                                3.4 Resultado del desafío
                            </h5>

                            <p>
                                Con el cliente en el ACS, pueden ocurrir los siguientes resultados:
                                <ul>
                                    <li>La autenticación es exitosa.</li>
                                    <li>La autenticación falla y el cliente no tiene otra oportunidad.</li>
                                    <li>La autenticación falla y el cliente tiene otra oportunidad.</li>
                                </ul>
                            </p>

                            <p>
                                Si el cliente ha completado con éxito el desafío y se ha autenticado, Addon Payments procederá a la autorización e incluirá los datos de autenticación de 3D Secure.
                                Alternativamente, en un escenario de transacción bloqueada, HPP devolverá un mensaje de respuesta de fallo (110).
                            </p>

                            <p>
                                En este punto, tanto en escenarios sin fricciones como en escenarios de desafío,
                                la transacción puede autorizarse o declinarse de manera normal en función de si el cliente tiene fondos suficientes en su cuenta o si ingresó su código de seguridad correctamente, etc.
                                Addon Payments devolverá la respuesta de la transacción junto con los datos de autenticación de 3D Secure adicionales que puede capturar en su sitio web/aplicación.
                            </p>

                        </div>
                    </div>

                    <div class="contenedor">
                        <div class="pl-3 pt-3 mb-2 pb-2 pr-3 text-justify">
                            <h3 class="pt-1" id="FormEjemplo1">
                                4. Formulario de ejemplo
                            </h3>

                            <hr>

                            <p>
                                Para poder procesar la transacción con el formulario de ejemplo en su identificador, debe modificar el archivo "AuthHpp3DS2Controller.cs" que se encuentra en la ruta "Controllers\3DS2\AuthHppController.cs".
                            </p>
                            <p>
                                Debe introducir sus datos de configuración tal y como se muestra en el punto 2.1 de esta guía.
                            </p>

                            <hr>
                            <h5 id="Formulario" class="mt-3">4.1 Formulario</h5>

                            <p>
                                El siguiente formulario le permite enviar una operación contra el entorno de pruebas de Addon Payments.
                            </p>

                            <div class="row justify-content-around">
                                <div class="col-lg-4">
                                    <div class="row">
                                        <div class="col-lg-12 pt-3 mt-2 mb-2 formulario">
                                            <div class="form-group row">
                                                <div class="col-sm-12">
                                                    <button type="submit" id="payButtonId" class="btn btn-block btn-primary">Enviar petición</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <hr>

                            <h5 id="respuestaForm">
                                4.2 Respuesta de la operación
                            </h5>

                            <small class="form-text text-muted alert alert-primary">
                                --&gt; La respuesta se obtiene mediante la excepción "try - catch" en el archivo "ResponseHppController.cs". Para ver más información puede ver la <a target="_blank" href="https://docs.microsoft.com/es-es/dotnet/standard/exceptions/how-to-use-the-try-catch-block-to-catch-exceptions">documentación oficial de .NET</a>
                            </small>
                        </div>
                    </div>
                </div>
                <!-- /Punto 3 -->

            </div>
            <!-- /Contenido común -->

        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="../../../../assets/js/barraprogreso.js"></script>

    <script>
        $(document).ready(function () {
            $.getJSON("/api/AuthHpp3DS2", function (jsonFromRequestEndpoint) {
                RealexHpp.setHppUrl("https://hpp.sandbox.addonpayments.com/pay");
                // When using full page redirect your Response URL must be an absolute link
                RealexHpp.redirect.init("payButtonId", "https://midominio.es/response", jsonFromRequestEndpoint);
            });
        });
    </script>

</body>
</html>