<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Víctor Cantera">
        <link rel="icon" href="../../../../assets/img/comercia_ico.png" type="image/x-icon"/ >
        <title>Crear un cliente (HPP) - SDK .NET</title>

        <!-- Bootstrap 4.3.1 -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

        <!-- CSS -->
        <link rel="stylesheet" href="../../../../assets/css/style.css">

        <!-- Script para comprobar los datos de la tarjeta mediante HPP -->
        <script src="../../../../assets/js/rxp-hpp.js"></script> <!-- Available at https://github.com/realexpayments -->
    </head>

    <body>
        <!-- NAVBAR -->
        <nav class="navbar navbar-expand-lg navbar-light navbar-rpdc mb-3">
            <a class="navbar-brand">
                <img src="../../../../assets/img/log2.svg" width="30" height="30" class="img-fluid" alt="Logo Addon Payments">
                <span class="addonNav">ADDON</span> <span>PAYMENTS</span>
                <span class="d-none d-sm-none d-lg-inline d-xl-inline sdkNav">
                    <span>
                        /SDK
                        <span class="barraNav">_</span>
                        de
                        <span class="barraNav">_</span>
                        .NET
                    </span>
                </span>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
          </a>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto pl-2 pr-2">
                    <li class="nav-item dropdown">
                        <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Inicio
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item pl-2" href="../../../../index.html">Índice</a>
                            <a class="dropdown-item pl-2" href="../../../errores.html">Errores de Addon Payments</a>
                            <a class="dropdown-item pl-2" href="../../../informe.html">Convertir informe</a>
                        </div>
                    </li>
                    <li class="nav-item ml-1 dropdown">
                        <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Pagos con tarjeta
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <div class="dropdown-header text-center p-0">API</div>
                            <hr class="m-0 p-0">
                            <a class="dropdown-item pl-2" href="../../../API/01%20-%20Pagos_con_tarjeta/01%20-%20Autorización/index.html">Autorización</a>
                            <a class="dropdown-item pl-2" href="../../../API/01%20-%20Pagos_con_tarjeta/01%20-%20Autorización/DatosDelCliente.html">Datos adicionales</a>
                            <a class="dropdown-item pl-2" href="../../../API/01%20-%20Pagos_con_tarjeta/02%20-%20OTB/index.html">OTB</a>
                            <a class="dropdown-item pl-2" href="../../../API/01%20-%20Pagos_con_tarjeta/03%20-%20Credit/index.html">Credit</a>
                            <hr class="m-0 p-0">
                            <div class="dropdown-header text-center p-0">HPP</div>
                            <hr class="m-0 p-0">
                            <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/01%20-%20Autorizacion/index.html">Autorización</a>
                            <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/02%20-%20OTB/index.html">OTB</a>
                            <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/03%20-%20Pay%20By%20Link/index.html">Pay By Link</a>
                            <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/04%20-%20Auth%20con%20iframe/index.html">Iframe</a>
                            <a class="dropdown-item pl-2" href="../../01%20-%20Pagos_con_tarjeta/05%20-%20Lightbox/index.html">Lightbox</a>
                        </div>
                    </li>
                    <li class="nav-item ml-1 dropdown">
                        <a class="nav-link pl-2 dropdown-toggle active" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Almacenamiento de tarjeta
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <div class="dropdown-header text-center p-0">API</div>
                            <hr class="m-0 p-0">
                            <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/01%20-%20Crear%20un%20cliente/index.html">Crear un cliente</a>
                            <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/02%20-%20Almacenar%20una%20tarjeta/index.html">Almacenar una tarjeta</a>
                            <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/03%20-%20Editar%20tarjeta/index.html">Editar tarjetas</a>
                            <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/04%20-%20Eliminar%20tarjeta/index.html">Eliminar tarjetas</a>
                            <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/05%20-%20Auth/index.html">Autorización</a>
                            <a class="dropdown-item pl-2" href="../../../API/02%20-%20Almacenamiento%20de%20tarjeta/06%20-%20Credit/index.html">Credit</a>
                            <hr class="m-0 p-0">
                            <div class="dropdown-header text-center p-0">HPP</div>
                            <hr class="m-0 p-0">
                            <a class="dropdown-item pl-2 active" href="#">Crear un cliente</a>
                            <a class="dropdown-item pl-2" href="../../02%20-%20Almacenamiento%20de%20tarjeta/02%20-%20Mostrar%20Tarjetas/index.html">Mostrar tarjetas</a>
                        </div>
                    </li>

                    <li class="nav-item ml-1 dropdown">
                        <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Gestión de transacciones
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item pl-2" href="../../../API/03%20-%20Gestión%20de%20transacciones/01%20-%20Capturar/index.html">Settle (Capturar)</a>
                            <a class="dropdown-item pl-2" href="../../../API/03%20-%20Gestión%20de%20transacciones/02%20-%20Rebate/index.html">Rebate (Devolución)</a>
                            <a class="dropdown-item pl-2" href="../../../API/03%20-%20Gestión%20de%20transacciones/03%20-%20Void/index.html">Void (Anular transacción)</a>
                        </div>
                    </li>

                    <li class="nav-item ml-1 dropdown">
                        <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Filtro de fraude
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">

                            <div class="dropdown-header text-center p-0">API</div>
                            <hr class="m-0 p-0">
                            <a class="dropdown-item pl-2" href="../../../API/05%20-%20Fraud%20Management/01%20-%20Fraud%20Filter/index.html">Filtro de fraude</a>
                            <a class="dropdown-item pl-2" href="../../../API/05%20-%20Fraud%20Management/02%20-%20Address%20Verification">Verificación de dirección</a>
                            <a class="dropdown-item pl-2" href="../../../API/05%20-%20Fraud%20Management/03%20-%20Hold">Retener transacción</a>
                            <a class="dropdown-item pl-2" href="../../../API/05%20-%20Fraud%20Management/04%20-%20Lanzamiento">Lanzar transacción</a>
                            <hr class="m-0 p-0">
                            <div class="dropdown-header text-center p-0">HPP</div>
                            <hr class="m-0 p-0">
                            <a class="dropdown-item pl-2" href="../../03%20-%20Fraud%20Management/01%20-%20Fraud%20Filter/index.html">Filtro de fraude</a>
                        </div>
                    </li>

                    <li class="nav-item ml-1 dropdown">
                        <a class="nav-link pl-2 dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            DCC
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <div class="dropdown-header text-center p-0">HPP</div>
                            <hr class="m-0 p-0">
                            <a class="dropdown-item pl-2" href="../../04%20-%20DCC/index.html">Operación con DCC</a>
                        </div>
                    </li>
                    <li class="nav-item ml-1 dropdown">
                        <a class="nav-link pl-2 dropdown-toggle" href="#" id="06-3DS2" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            3DS2
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <div class="dropdown-header text-center p-0">API</div>
                            <hr class="m-0 p-0">
                            <a class="dropdown-item pl-2" href="../../../API/06%20-%203DS2/01%20-%20Autorización/index.html">Autorización</a>
                            <hr class="m-0 p-0">
                            <div class="dropdown-header text-center p-0">HPP</div>
                            <hr class="m-0 p-0">
                            <a class="dropdown-item pl-2" href="../../05%20-%203DS2/01%20-%20Autorización/index.html">Autorización</a>
                            <a class="dropdown-item pl-2" href="../../05%20-%203DS2/02%20-%20Datos%20adicionales/index.html">Datos adicionales</a>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
        <!-- /NAVBAR -->

        <div class="col-lg-12"> 
            <div id="contenidoComun" class="container-fluid">
                <div class="row">

                    <!-- Menú lateral -->
                    <div class="col-lg-2 sticky-top d-none d-sm-none d-lg-block d-xl-block MenuLateral">

                        <!-- Barra de progreso -->
                        <div class="progress-bar" id="progreso"></div>
                        <!-- /Barra de progreso -->

                        <nav class="navbar sticky-top navbar-light" style="padding: 0px;">
                            <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="#newClient">1. Crear cliente</a>
                                <nav class="nav nav-pills flex-column">
                                    <a class="nav-link ml-3 my-1" href="#codigoEjemplo">1.1 Código de ejemplo</a>
                                </nav>
                                <a class="nav-link" href="#descripciones">2. Descripciones</a>
                                <nav class="nav nav-pills flex-column">
                                    <a class="nav-link ml-3 my-1" id="#ConfigTerminal" href="#ConfigTerminal">2.1 Configuración del terminal</a>
                                    <a class="nav-link ml-3 my-1" id="#cardStorage" href="#cardStorage">2.2 Card Storage</a>
                                    <a class="nav-link ml-3 my-1" id="#envioOP" href="#envioOP">2.3 Envío de la operación</a>
                                </nav>
                                <a class="nav-link" href="#FormEjemplo1">3. Formulario de ejemplo</a>
                                <nav>
                                    <a class="nav-link ml-3 my-1" href="#Formulario">3.1 Formulario</a>
                                    <a class="nav-link ml-3 my-1" href="#respuestaForm">3.2 Respuesta de operación</a>
                                </nav>
                            </nav>
                        </nav>
                    </div>

                    <div class="col-lg-10" >
                        <!-- Punto 1 -->
                        <div class="contenedor">
                            <div class="pl-3 pt-3 pr-3 pb-4 mb-3 text-justify">
                                <h3 id="newClient" class="titulo">
                                    1. Crear cliente
                                </h3>
                                <hr>

                                <p>
                                   Para habilitar el almacenamiento de tarjetas, simplemente añadimos tres campos a nuestra solicitud de HPP. También puede optar por proporcionar sus propias referencias para el cliente y la tarjeta. Este tipo de solicitud comprueba que se trata de una tarjeta válida y activa y que el cliente ha proporcionado el código de seguridad, los detalles de la dirección y la autenticación 3D Secure correctos. También podemos optar por proporcionar al cliente la opción de guardar su tarjeta o guardarla automáticamente.
                                </p>

                                <p>
                                    Las referencias del cliente y de la tarjeta sólo se crearán y devolverán en la respuesta si la autorizaciónes correcta.
                                </p>

                                <h5 style="" class="pt-3" id="codigoEjemplo">
                                    1.1 Código de ejemplo
                                </h5>
                                
                                <hr>

                                <div class="p-4 panelCode">
                                    <code>
                                            <span class="etiqueta">using </span><span class="variables">Microsoft.AspNetCore.Mvc;</span>
                                        <br>
                                            <span class="etiqueta">using </span><span class="variables">GlobalPayments.Api;</span>
                                        <br>
                                            <span class="etiqueta">using </span><span class="variables">GlobalPayments.Api.Entities;</span>
                                        <br>
                                            <span class="etiqueta">using </span><span class="variables">GlobalPayments.Api.Services;</span>
                                        <br>
                                        <br>
                                            <span class="etiqueta">namespace </span><span class="variables">AddonPayments.Controllers {</span>
                                        <br>
                                            <span class="pl-4 variables">[</span><span class="imports">ApiController</span><span class="variables">]</span>
                                        <br>
                                            <span class="pl-4 variables">[</span><span class="imports">Route</span><span class="variables">(</span><span class="orange">"[Controller]"</span><span class="variables">)]</span>
                                        <br>
                                        <br>
                                            <span class="pl-4 etiqueta">public class </span><span class="imports">CustomerHppController</span><span class="variables">: </span><span class="imports">ControllerBase </span><span class="variables">{</span>
                                        <br>
                                            <span class="pl-5 variables">[</span><span class="imports">HttpPost</span><span class="variables">]</span>
                                        <br>
                                            <span class="pl-5 etiqueta">public </span><span class="service">IActionResult </span><span class="variables">CustomerHpp() {</span>
                                        <br>
                                        <br>
                                            <span class="pl-6 comments">// Configuramos los datos de nuestro comercio. Los datos son proporcionados por el equipo de Addon Payments,</span>
                                       <br>
                                           <span class="pl-6 comments">// en caso de duda debe llamar al 914 353 028 e indicar su número de comercio o Merchant ID</span>
                                        <br>
                                            <span class="pl-6 new">var </span><span class="variables">service = </span><span class="new">new </span><span class="imports">HostedService</span><span class="variables">(</span><span class="new">new </span><span class="imports">GatewayConfig </span><span class="variables">{</span>
                                        <br>
                                            <span class="pl-7 variables">MerchantId = </span><span class="orange">"addonnettest"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-7 variables">AccountId = </span><span class="orange">"api"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-7 variables">SharedSecret = </span><span class="orange">"secret"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-7 variables">ServiceUrl = </span><span class="orange">"https://hpp.sandbox.addonpayments.com/pay"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-7 variables">HostedPaymentConfig = </span><span class="new">new </span><span class="imports">HostedPaymentConfig </span><span class="variables">{</span>
                                        <br>
                                            <span class="pl-9 variables">Version = </span><span class="orange">"2"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-9 variables">CardStorageEnabled = </span><span class="new">true</span>
                                        <br>
                                            <span class="pl-7 variables">}</span>
                                        <br>
                                            <span class="pl-6 variables">});</span>
                                        <br>
                                        <br>
                                            <span class="pl-6 comments">// Datos que deben transferirse al servidor de Addon Payments junto con las opciones de nivel de transacción</span>
                                        <br>
                                            <span class="pl-6 new">var </span><span class="variables">hostedPaymentData = </span><span class="new">new </span><span class="imports">HostedPaymentData </span><span class="variables">{</span>
                                        <br>
                                            <span class="pl-7 variables">OfferToSaveCard = </span><span class="new">true</span><span class="variables">, </span><span class="comments">// Mostrar la casilla para guardar la tarjeta</span>
                                        <br>
                                            <span class="pl-7 variables">CustomerExists = </span><span class="new">false </span><span class="comments">// Nuevo cliente</span>
                                        <br>
                                        <br>
                                            <span class="pl-7 comments">// Puede introducir sus propias keys para la tarjeta y el cliente</span>
                                        <br>
                                            <span class="pl-7 comments">// CustomerKey = "a7960ada-3da9-4a5b-bca5-7942085b03c6",</span>
                                        <br>
                                            <span class="pl-7 comments">// PaymentKey = "48fa69fe-d785-4c27-876d-6ccba660fa2b"</span>
                                        <br>
                                        <br>
                                            <span class="pl-6 variables">};</span>
                                        <br>
                                        <br>
                                            <span class="pl-6 comments">// Lanzamos la petición al servidor de Addon Payments</span>
                                        <br>
                                            <span class="pl-6 new">try </span><span class="variables">{</span>
                                        <br>
                                            <span class="pl-7 new">var </span><span class="variables">hppJson = service.Charge(</span><span class="imports">19.95m</span><span class="variables">)</span>
                                        <br>
                                            <span class="pl-9 variables">.WithCurrency(</span><span class="orange">"EUR"</span><span class="variables">)</span>
                                        <br>
                                            <span class="pl-9 variables">.WithHostedPaymentData(hostedPaymentData)</span>
                                        <br>
                                            <span class="pl-9 variables">.Serialize();</span>
                                        <br>
                                        <br>
                                            <span class="comments pl-7">// Obtenemos la respuesta del servidor y redireccionamos al cliente a la pasarela de pagos</span>
                                        <br>
                                            <span class="pl-7 new">return </span><span class="variables">Content(hppJson);</span>
                                        <br>
                                        <br>
                                            <span class="pl-6 variables">}</span><span class="new"> catch </span><span class="variables">(</span><span class="imports">ApiException </span><span class="variables">exce</span><span class="variables">) {</span>
                                        <br>
                                            <span class="comments pl-7">// Añada aquí su tratamiento de errores</span>
                                        <br>
                                            <span class="pl-7 new">return </span><span class="variables">Ok(exce);</span>
                                        <br>
                                            <span class="pl-6 variables">}</span>
                                        <br>
                                            <span class="pl-5 variables">}</span>
                                        <br>
                                            <span class="pl-4 variables">}</span>
                                        <br>
                                            <span class="variables">}</span>
                                    </code>
                                </div>
                            </div>
                        </div>

                        <div class="contenedor">
                            <div class="pl-3 pt-3 pr-3 pb-1 mb-3 text-justify">
                                <h3 class="pt-1" id="descripciones">
                                    2. Descripciones
                                </h3>

                                <hr>

                                <h5 id="ConfigTerminal" class="mt-3">
                                    2.1 Configuración del terminal
                                </h5>

                                <p>
                                   Debemos introducir los datos de configuración que se facilitan en la llamada de cualificación del soporte técnico de Addon Payments.
                                </p>

                                <ul>
                                   <li>
                                       Merchant_ID = Identificador del comercio.
                                   </li>
                                   <li>
                                       SubAccount = Subcuenta faciltiada en la llamada de cualificación (en caso de que se envíe la operación sin subcuenta, se usará la establecida por defecto en la creación de su terminal).
                                   </li>
                                   <li>
                                       Shared Secret = Contraseña de seguridad del terminal.
                                   </li>
                                </ul>
                                <small class="form-text text-muted alert alert-primary">
                                    --&gt; En caso de que le falte algún dato de los mencionados arriba, debe contactar con su soporte técnico de Addon Payments llamando al teléfono 914 353 028 (opción 2) o enviando un email al correo electrónico <a target="_blank" href="mailto:soporteaddonpayments.com">soporteaddonpayments.com</a>.
                                </small>
                                <div class="p-4 mb-4 panelCode">
                                    <code>
                                            <span class="new">var </span><span class="variables">service = </span><span class="new">new </span><span class="imports">HostedService</span><span class="variables">(</span><span class="new">new </span><span class="imports">GatewayConfig </span><span class="variables">{</span>
                                        <br>
                                            <span class="pl-4 variables">MerchantId = </span><span class="orange">"addonnettest"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-4 variables">AccountId = </span><span class="orange">"api"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-4 variables">SharedSecret = </span><span class="orange">"secret"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-4 variables">ServiceUrl = </span><span class="orange">"https://hpp.sandbox.addonpayments.com/pay"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-4 variables">HostedPaymentConfig = </span><span class="new">new </span><span class="imports">HostedPaymentConfig </span><span class="variables">{</span>
                                        <br>
                                            <span class="pl-6 variables">Version = </span><span class="orange">"2"</span><span class="variables">,</span>
                                        <br>
                                            <span class="pl-6 variables">CardStorageEnabled = </span><span class="new">true</span>
                                        <br>
                                            <span class="pl-4 variables">}</span>
                                        <br>
                                            <span class="variables">});</span>
                                    </code>
                                </div>

                                <hr>

                                <h5 id="cardStorage" class="mt-3">
                                    2.2 Card Storage
                                </h5>

                                    <p>
                                       Para almacenar una tarjeta mediante HPP, debemos enviar los siguientes parámetros:
                                    </p>

                                    <ul>
                                        <li>
                                            Creamos un nuevo objeto "hostedPaymentData ":
                                        </li>
                                        <ul>
                                            <li>
                                                <span class="arrow">hostedPaymentData </span><span class="arrow"> = </span> <span class="arrow">new HostedPaymentData</span>
                                            </li>
                                        </ul>

                                        <li>
                                            Mostramos la casilla al cliente donde solicitamos que verifique si desea guardar su tarjeta: 
                                        </li>
                                        <ul>
                                            <li>
                                                <span class="variableBgW">OfferToSaveCard</span><span class="require"> = </span><span class="orangeBgW">true</span><span class="arrow">,</span>
                                            </li>
                                        </ul>

                                        <li>
                                            Indicamos que es un cliente nuevo:
                                        </li>
                                        <ul>
                                            <li>
                                                <span class="variableBgW">CustomerExists</span><span class="require"> = </span><span class="orangeBgW">false</span>
                                            </li>
                                        </ul>
                                    </ul>

                                    <div class="p-4 mb-4 panelCode">
                                        <code>
                                                <span class="comments">// Datos que deben transferirse al servidor de Addon Payments junto con las opciones de nivel de transacción</span>
                                            <br>
                                                <span class="new">var </span><span class="variables">hostedPaymentData = </span><span class="new">new </span><span class="imports">HostedPaymentData </span><span class="variables">{</span>
                                            <br>
                                                <span class="pl-4 variables">OfferToSaveCard = </span><span class="new">true</span><span class="variables">, </span><span class="comments">// Mostrar la casilla para guardar la tarjeta</span>
                                            <br>
                                                <span class="pl-4 variables">CustomerExists = </span><span class="new">false </span><span class="comments">// Nuevo cliente</span>
                                            <br>
                                            <br>
                                                <span class="pl-4 comments">// Puede introducir sus propias keys para la tarjeta y el cliente</span>
                                            <br>
                                                <span class="pl-4 comments">// CustomerKey = "a7960ada-3da9-4a5b-bca5-7942085b03c6",</span>
                                            <br>
                                                <span class="pl-4 comments">// PaymentKey = "48fa69fe-d785-4c27-876d-6ccba660fa2b"</span>
                                            <br>
                                            <br>
                                                <span class="variables">};</span>
                                        </code>
                                    </div>

                                <hr>

                                <h5 id="envioOP" class="mt-3">
                                    2.3 Envío de la operación
                                </h5>

                                <p>
                                    Para enviar la operación debemos emplear el modelo de excepciones "try - catch". 
                                    <small class="form-text text-muted alert alert-primary">
                                        --&gt;Para obtener más información sobre la excepción de "try - catch" puede ver la <a target="_blank" href="https://docs.microsoft.com/es-es/dotnet/standard/exceptions/how-to-use-the-try-catch-block-to-catch-exceptions">documentación oficial de .NET</a>
                                    </small>
                                </p>

                                <ul>
                                    <li>
                                        Comprobamos la tarjeta realizándole un cargo de mínimo 10 céntimos: 
                                    </li>
                                    <ul>
                                        <li>
                                           <span class="variableBgW">service</span><span class="arrow">.Charge(</span><span class="comentariosBgW">19.95m</span><span class="arrow">);</span>
                                        </li>
                                    </ul>

                                    <br>

                                    <li>
                                        Indicamos la moneda con la que vamos a realizar la operación: 
                                    </li>
                                    <ul>
                                        <li>
                                            <span class="arrow">.WithCurrency("</span><span class="comentariosBgW">EUR</span><span class="arrow">")</span>
                                        </li>
                                    </ul>

                                    <br>

                                    <li>
                                        Indicamos los datos de configuración de Card Storage: 
                                    </li>
                                    <ul>
                                        <li>
                                            <span class="arrow">.WithHostedPaymentData(</span><span class="variableBgW">hostedPaymentData</span><span class="arrow">)</span>
                                        </li>
                                    </ul>

                                    <br>

                                    <li>
                                        Serializamos los datos: 
                                    </li>
                                    <ul>
                                        <li>
                                            <span class="arrow">.Serialize();</span>
                                        </li>
                                    </ul>

                                    <br>

                                    <li>
                                        Mostramos el formulario realizando un "return" del JSON generado:
                                    </li>
                                    <ul>
                                        <li>
                                            <span class="arrow">return Content(</span><span class="variableBgW">hppJson</span><span class="arrow">);</span>
                                        </li>
                                    </ul>

                                </ul>
                                <div class="p-4 mb-4 panelCode">
                                    <code>
                                        <span class="comments">// Lanzamos la petición al servidor de Addon Payments</span>
                                        <br>
                                            <span class="new">try </span><span class="variables">{</span>
                                        <br>
                                            <span class="pl-4 new">var </span><span class="variables">hppJson = service.Charge(</span><span class="imports">19.95m</span><span class="variables">)</span>
                                        <br>
                                            <span class="pl-6 variables">.WithCurrency(</span><span class="orange">"EUR"</span><span class="variables">)</span>
                                        <br>
                                            <span class="pl-6 variables">.WithHostedPaymentData(hostedPaymentData)</span>
                                        <br>
                                            <span class="pl-6 variables">.Serialize();</span>
                                        <br>
                                        <br>
                                            <span class="comments pl-5">// Obtenemos la respuesta del servidor y redireccionamos al cliente a la pasarela de pagos</span>
                                        <br>
                                            <span class="pl-5 new">return </span><span class="variables">Content(hppJson);</span>
                                        <br>
                                        <br>
                                            <span class="variables">}</span><span class="new"> catch </span><span class="variables">(</span><span class="imports">ApiException </span><span class="variables">exce</span><span class="variables">) {</span>
                                        <br>
                                            <span class="comments pl-5">// Añada aquí su tratamiento de errores</span>
                                        <br>
                                            <span class="pl-5 new">return </span><span class="variables">Ok(exce);</span>
                                        <br>
                                            <span class="variables">}</span>
                                    </code>
                                </div>

                                <p class="pb-4">
                                    Para la respuesta realizamos un <span class="arrow">return Ok()</span> de "<span class="arrow">exce</span>".
                                    <br>
                                    <br>
                                    Con esta función obtenemos el motivo de la denegación del servidor. Para ver todos los errores de denegación actualizados, puede comprobar nuestra <a target="_blank" href="https://desarrolladores.addonpayments.com/#!/technical-resources/messages">documentación de Addon Payments.</a>
                                </p>

                            </div>
                        </div>

                        <div class="contenedor">
                            <div class="pl-3 pt-3 pr-3 pb-4 mb-3 text-justify">
                                <h3 class="pt-1" id="FormEjemplo1">
                                    3. Formulario de ejemplo
                                </h3>

                                <hr>

                                <p>
                                    Para poder procesar la transacción con el formulario de ejemplo en su identificador, debe modificar el archivo "CustomerHppController.cs" que se encuentra en la ruta "Controllers\CustomerHppController.cs".
                                </p>

                                <p>
                                    Debe introducir sus datos de configuración tal y como se muestra en el punto 2.1 "Configuración del terminal".
                                </p>

                                <hr>

                                <h5 id="Formulario" class="mt-3">
                                    3.1 Formulario
                                </h5>

                                <p>
                                    El siguiente formulario le permite crear un cliente contra el entorno de pruebas de Addon Payments. Puede acceder al panel de administración ingresando en la siguiente URL e introduciendo sus datos de inicio de sesión:
                                    <ul>
                                         <li><a target="_blank" href="https://admin.sandbox.addonpayments.com">https://admin.sandbox.addonpayments.com.</a></li>
                                    </ul>
                                </p>

                                <div class="row justify-content-around">
                                    <div class="col-lg-4">
                                        <div class="row">
                                            <div class="col-lg-12 pt-3 mt-2 mb-2 formulario">
                                                <div class="form-group row">
                                                    <div class="col-sm-12">
                                                        <button type="submit" id="payButtonId" class="btn btn-block btn-primary">Crear cliente</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr>

                                <h5 id="respuestaForm">
                                    3.2 Respuesta de la operación
                                </h5>

                                <small class="form-text text-muted alert alert-primary">
                                    --&gt; La respuesta se obtiene mediante la excepción "try - catch" en el archivo "ResponseHppController.cs". Para ver más información puede ver la <a target="_blank" href="https://docs.microsoft.com/es-es/dotnet/standard/exceptions/how-to-use-the-try-catch-block-to-catch-exceptions">documentación oficial de .NET</a>
                                </small>
                            </div>
                        </div>
                        <!-- /Punto 3 -->
                    
                    </div>
                    <!-- /Contenido común -->

                </div>
            </div>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
        <script src="../../../../assets/js/barraprogreso.js"></script>

        <script>
          $(document).ready(function() {
              $.getJSON("/CustomerHpp", function(jsonFromRequestEndpoint) {
              RealexHpp.setHppUrl("https://hpp.sandbox.addonpayments.com/pay");
              // When using full page redirect your Response URL must be an absolute link
              RealexHpp.redirect.init("payButtonId", "https://midominio.es/response.html", jsonFromRequestEndpoint);
              });
          });
        </script>
        
    </body>
</html>
